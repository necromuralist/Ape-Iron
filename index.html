<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Ironies of the Ape." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Ape Iron</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Ape-Iron/" rel="canonical"><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script><!--
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js"
</script>

<script type="text/javascript" async
  src="../../../assets/javascript/p5.min.js"
</script>
--><!-- favicons -->
<link href="apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="site.webmanifest" rel="manifest">
<link href="posts/making-comics/" rel="prefetch" type="text/html">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="."><span id="blog-title">Ape Iron</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Pages</a>
<div class="dropdown-menu"><a class="dropdown-item active" href=".">Cloistered Monkey <span class="sr-only">(active)</span></a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Ape-Iron/"><input name="k8" type="hidden" value="#444444"><input name="k9" type="hidden" value="#D51920"><input name="kt" type="hidden" value="h"><input class="span2" maxlength="255" name="q" placeholder="Search…" type="text"><input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/making-comics/">Making Comics</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/making-comics/" rel="bookmark"><time class="published dt-published" datetime="2020-09-20T18:17:42-07:00" itemprop="datePublished" title="2020-09-20 18:17">2020-09-20 18:17</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div class="outline-2" id="outline-container-org2b7b65b">
<h2 id="org2b7b65b">Biblography</h2>
<div class="outline-text-2" id="text-org2b7b65b">
<ul class="org-ul">
<li>Barry L. Making comics. Montreal, Quebec: Drawn & Quarterly; 2019. 198 p.</li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/wikipedia-list-of-countries/">Wikipedia List of Countries</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/wikipedia-list-of-countries/" rel="bookmark"><time class="published dt-published" datetime="2020-09-18T20:27:51-07:00" itemprop="datePublished" title="2020-09-18 20:27">2020-09-18 20:27</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/wikipedia-list-of-countries/#org13da5e9">Beginning</a>
<ul>
<li><a href="posts/wikipedia-list-of-countries/#orgd2cdfd9">Set Up</a></li>
</ul>
</li>
<li><a href="posts/wikipedia-list-of-countries/#orga4003fa">Middle</a>
<ul>
<li><a href="posts/wikipedia-list-of-countries/#orga362428">Grabbing Some HTML</a></li>
<li><a href="posts/wikipedia-list-of-countries/#orgf0a4de0">Plotting</a></li>
<li><a href="posts/wikipedia-list-of-countries/#org0c3a6d6">Just the Population Table</a></li>
<li><a href="posts/wikipedia-list-of-countries/#org33d54aa">Countries by Area</a></li>
</ul>
</li>
<li><a href="posts/wikipedia-list-of-countries/#org3095031">Plotting Again</a>
<ul>
<li><a href="posts/wikipedia-list-of-countries/#org77b2155">By Area</a></li>
<li><a href="posts/wikipedia-list-of-countries/#orgb0feab6">By Population</a></li>
<li><a href="posts/wikipedia-list-of-countries/#org2120292">By Density</a></li>
</ul>
</li>
<li><a href="posts/wikipedia-list-of-countries/#org29a3271">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org13da5e9">
<h2 id="org13da5e9">Beginning</h2>
<div class="outline-text-2" id="text-org13da5e9"></div>
<div class="outline-3" id="outline-container-orgd2cdfd9">
<h3 id="orgd2cdfd9">Set Up</h3>
<div class="outline-text-3" id="text-orgd2cdfd9"></div>
<div class="outline-4" id="outline-container-org6a2de27">
<h4 id="org6a2de27">Imports</h4>
<div class="outline-text-4" id="text-org6a2de27">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">argparse</span> <span class="kn">import</span> <span class="n">Namespace</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">HoverTool</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">hvplot.pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># others</span>
<span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">EmbedHoloviews</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org06e7dcc">
<h4 id="org06e7dcc">Plotting</h4>
<div class="outline-text-4" id="text-org06e7dcc">
<div class="highlight">
<pre><span></span><span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"wikipedia-list-of-countries"</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedHoloviews</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="n">f</span><span class="s2">"files/posts/{SLUG}"</span><span class="p">)</span>
<span class="n">Plot</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">990</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">780</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org76228c0">
<h4 id="org76228c0">Set Up Tabulate</h4>
<div class="outline-text-4" id="text-org76228c0">
<p>This is just to make printing the pandas data-frames a little easier. <a href="https://github.com/nnicandro/emacs-jupyter">emacs-jupyter</a> actually does a pretty good job of rendering them as HTML like a regular jupyter notebook, but this makes it a little more readable while in emacs, plus I can control things better.</p>
<div class="highlight">
<pre><span></span><span class="n">TABLE</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">tabulate</span><span class="p">,</span> <span class="n">showindex</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org5d74de5">
<h4 id="org5d74de5">Set Up Selenium</h4>
<div class="outline-text-4" id="text-org5d74de5">
<div class="highlight">
<pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">FirefoxOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">headless</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">(</span><span class="n">firefox_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orga4003fa">
<h2 id="orga4003fa">Middle</h2>
<div class="outline-text-2" id="text-orga4003fa"></div>
<div class="outline-3" id="outline-container-orga362428">
<h3 id="orga362428">Grabbing Some HTML</h3>
<div class="outline-text-3" id="text-orga362428"></div>
<div class="outline-4" id="outline-container-org9c34c2d">
<h4 id="org9c34c2d">Build the Table</h4>
<div class="outline-text-4" id="text-org9c34c2d">
<p>The tables are created using javascript so we need to use Selenium (or something else that handles javascript) to get the page for us.</p>
<div class="highlight">
<pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s2">"https://www.wikiwand.com/en/List_of_countries_and_dependencies_by_population_density"</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</pre></div>
<p>Now we can let pandas convert the table to a data-frame. In this case there's multiple tables on the page but I only want the first one.</p>
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<pre class="example">
| ('Rank', 'Rank')   | ('Country (or dependent territory)', 'Country (or dependent territory)')   |   ('Area', 'km2') |   ('Area', 'mi2') |   ('Population', 'Population') |   ('Density', 'pop./km2') |   ('Density', 'pop./mi2') | ('Date', 'Date')   | ('Population source', 'Population source')   |
|--------------------+----------------------------------------------------------------------------+-------------------+-------------------+--------------------------------+---------------------------+---------------------------+--------------------+----------------------------------------------|
| –                  | Macau (China)                                                              |             115.3 |                45 |                         696100 |                     21158 |                     54799 | September 30, 2019 | Official quarterly estimate                  |
</pre>
<p>That kind of worked but the column names are odd, and I don't want all of them anyway so I'll fix that.</p>
<div class="highlight">
<pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Rank</th>
<th class="org-left" scope="col">Country (or dependent territory)</th>
<th class="org-right" scope="col">Area</th>
<th class="org-right" scope="col">Area</th>
<th class="org-right" scope="col">Population</th>
<th class="org-right" scope="col">Density</th>
<th class="org-right" scope="col">Density</th>
<th class="org-left" scope="col">Date</th>
<th class="org-left" scope="col">Population source</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">–</td>
<td class="org-left">Macau (China)</td>
<td class="org-right">115.3</td>
<td class="org-right">45</td>
<td class="org-right">696100</td>
<td class="org-right">21158</td>
<td class="org-right">54799</td>
<td class="org-left">September 30, 2019</td>
<td class="org-left">Official quarterly estimate</td>
</tr>
</tbody>
</table>
<p>Now, I messed up the units for area and density, but I'm not good with the metric system and Density is a calculated column anyway, so maybe I should get rid of some columns to make it easier.</p>
<div class="highlight">
<pre><span></span><span class="n">Columns</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span>
    <span class="n">rank</span><span class="o">=</span><span class="s2">"Rank"</span><span class="p">,</span>
    <span class="n">date</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="s2">"Population source"</span><span class="p">,</span>
    <span class="n">area</span><span class="o">=</span><span class="s2">"Area (square miles)"</span><span class="p">,</span>
    <span class="n">area_cleaned</span> <span class="o">=</span> <span class="s2">"Area"</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="s2">"Density (population/square miles)"</span><span class="p">,</span>
    <span class="n">density_cleaned</span> <span class="o">=</span> <span class="s2">"Density"</span><span class="p">,</span>
    <span class="n">country</span><span class="o">=</span><span class="s2">"Country (or dependent territory)"</span><span class="p">,</span>
    <span class="n">country_cleaned</span> <span class="o">=</span> <span class="s2">"Country"</span><span class="p">,</span>
    <span class="n">population</span><span class="o">=</span><span class="s2">"Population"</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"remove"</span>
<span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Columns</span><span class="o">.</span><span class="n">area</span>
<span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"remove2"</span>
<span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">Columns</span><span class="o">.</span><span class="n">density</span>
<span class="n">table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>

<span class="k">del</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">"remove"</span><span class="p">])</span>
<span class="k">del</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">"remove2"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<pre class="example">
| Rank   | Country (or dependent territory)   |   Area (square miles) |   Population |   Density (population/square miles) | Date               | Population source           |
|--------+------------------------------------+-----------------------+--------------+-------------------------------------+--------------------+-----------------------------|
| –      | Macau (China)                      |                    45 |       696100 |                               54799 | September 30, 2019 | Official quarterly estimate |
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgebc2bb1">
<h4 id="orgebc2bb1">The Last Two Rows</h4>
<div class="outline-text-4" id="text-orgebc2bb1">
<p>I guess because the table is so long Wikipedia repeats the header at the bottom of the table.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Rank</th>
<th class="org-left" scope="col">Country (or dependent territory)</th>
<th class="org-left" scope="col">Area (square miles)</th>
<th class="org-left" scope="col">Population</th>
<th class="org-left" scope="col">Density (population/square miles)</th>
<th class="org-left" scope="col">Date</th>
<th class="org-left" scope="col">Population source</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Rank</td>
<td class="org-left">Country (or dependent territory)</td>
<td class="org-left">mi2</td>
<td class="org-left">Population</td>
<td class="org-left">pop./mi2</td>
<td class="org-left">Date</td>
<td class="org-left">Population source</td>
</tr>
<tr>
<td class="org-left">Rank</td>
<td class="org-left">Country (or dependent territory)</td>
<td class="org-left">Area</td>
<td class="org-left">Population</td>
<td class="org-left">Density</td>
<td class="org-left">Date</td>
<td class="org-left">Population source</td>
</tr>
</tbody>
</table>
<p>So we have to remove them and also convert the numeric columns to numeric types since pandas had to render them all as objects (strings).</p>
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Rank</th>
<th class="org-left" scope="col">Country (or dependent territory)</th>
<th class="org-right" scope="col">Area (square miles)</th>
<th class="org-right" scope="col">Population</th>
<th class="org-right" scope="col">Density (population/square miles)</th>
<th class="org-left" scope="col">Date</th>
<th class="org-left" scope="col">Population source</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">–</td>
<td class="org-left">Svalbard and Jan Mayen (Norway)</td>
<td class="org-right">23706</td>
<td class="org-right">2655</td>
<td class="org-right">0.1</td>
<td class="org-left">September 1, 2012</td>
<td class="org-left">Official estimate</td>
</tr>
<tr>
<td class="org-left">–</td>
<td class="org-left">Greenland (Denmark)</td>
<td class="org-right">836297</td>
<td class="org-right">55877</td>
<td class="org-right">0.08</td>
<td class="org-left">January 1, 2018</td>
<td class="org-left">Official estimate</td>
</tr>
</tbody>
</table>
<p>I'm guessing that there's no fractional populations, but if you look at the areas some of them are non-integers.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">area</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
<pre class="example">
0.19
</pre>
<p>So only the population is an integer (I'm assuming).</p>
<div class="highlight">
<pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">Columns</span><span class="o">.</span><span class="n">density</span><span class="p">]:</span>
    <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">table</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf0a4de0">
<h3 id="orgf0a4de0">Plotting</h3>
<div class="outline-text-3" id="text-orgf0a4de0">
<p>This is just to take a look.</p>
</div>
<div class="outline-4" id="outline-container-org3931c0f">
<h4 id="org3931c0f">By Area</h4>
<div class="outline-text-4" id="text-org3931c0f">
<p>First I'll sort the table by area using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sort_values.html">sort_values</a>.</p>
<div class="highlight">
<pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="n">Columns</span><span class="o">.</span><span class="n">area</span><span class="p">:</span> <span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span>
    <span class="n">Columns</span><span class="o">.</span><span class="n">density</span><span class="p">:</span> <span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">,</span>
    <span class="n">Columns</span><span class="o">.</span><span class="n">country</span><span class="p">:</span> <span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">country</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"@{Columns.country_cleaned}"</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"@{Columns.population}{{0,0}}"</span>
<span class="n">density</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"@{{{Columns.density_cleaned}}}"</span>
<span class="n">area</span> <span class="o">=</span>  <span class="n">f</span><span class="s2">"@{Columns.area_cleaned}{{0,0.00}} (Square Miles)"</span>
<span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span><span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">"Country"</span><span class="p">,</span> <span class="n">country</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"Area"</span><span class="p">,</span> <span class="n">area</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"Population"</span><span class="p">,</span> <span class="n">population</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"Density"</span><span class="p">,</span> <span class="n">density</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span>
                           <span class="n">y</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span>
                           <span class="n">hover_cols</span><span class="o">=</span><span class="p">[</span>
                               <span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">,</span>
                               <span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span>
                           <span class="p">])</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                               <span class="n">title</span><span class="o">=</span><span class="s2">"Countries by Area"</span><span class="p">,</span>
                               <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                               <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                               <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
                           <span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"countries_by_area"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/wikipedia-list-of-countries/countries_by_area.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Well, that's not so easy to read. Maybe just the top and bottom ten.</p>
<div class="highlight">
<pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span>
                          <span class="n">hover_cols</span><span class="o">=</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">,</span>
                                      <span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">])</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Top Ten Countries by Area"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
    <span class="n">xrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"top_ten_countries_by_area"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/wikipedia-list-of-countries/top_ten_countries_by_area.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>So, this shows us a few things to fix. One, the first row is likely just the sum of the others, I would think… But even if it isn't it's so big that it kind of throws stuff off. Also we could probably suck out Antarctica from the second row to make the table match the one Wikipedia has of just countries by area.</p>
<p>The other thing is that there are reference to notes that I don't know that I want.</p>
<div class="highlight">
<pre><span></span><span class="n">numeric</span> <span class="o">=</span> <span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span> <span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">,</span> <span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">]</span>
<span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="n">Columns</span><span class="o">.</span><span class="n">area</span><span class="p">:</span> <span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span>
    <span class="n">Columns</span><span class="o">.</span><span class="n">density</span><span class="p">:</span> <span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">,</span>
    <span class="n">Columns</span><span class="o">.</span><span class="n">country</span><span class="p">:</span> <span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">world</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">numeric</span><span class="p">]</span>
<span class="n">without_antarctica</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">numeric</span><span class="p">]</span>
<span class="n">antarctica</span> <span class="o">=</span> <span class="n">world</span> <span class="o">-</span> <span class="n">without_antarctica</span>
<span class="n">antarctica</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">rank</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"-"</span>
<span class="n">antarctica</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">country</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Antarctica"</span>
<span class="n">antarctica</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotter</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">date</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">antarctica</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotter</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">antarctica</span> <span class="o">=</span> <span class="n">antarctica</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
<span class="n">antarctica</span> <span class="o">=</span> <span class="n">antarctica</span><span class="p">[</span><span class="n">plotter</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">cleaned</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">antarctica</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">antarctica</span><span class="p">)</span>
</pre></div>
<pre class="example">
Rank                                             -
Country                                 Antarctica
Area                                      5.41e+06
Population                                       0
Density                                        -14
Date                            September 19, 2020
Population source    USCB's World population clock
dtype: object
</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Area Difference: {world[Columns.area_cleaned] - cleaned[Columns.area_cleaned].sum():,.2f}"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Population Difference: {world[Columns.population] - cleaned[Columns.population].sum():,}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Area Difference: -554,000.57
Population Difference: 168,435,684
</pre>
<p>So, it doesn't actually match the way I thought. I guess there are parts of the world that aren't part of a country… That's a huge difference in population, though… I'll have to investigate that separately.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org0c3a6d6">
<h3 id="org0c3a6d6">Just the Population Table</h3>
<div class="outline-text-3" id="text-org0c3a6d6">
<p>For some reason pandas is acting up here so I had to separate the building of the dataframe and re-running the code blocks a few times. It even said that pandas couldn't find html5lib, which is kind of weird since the earlier <code>read_html</code> call worked…</p>
<div class="highlight">
<pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s2">"https://www.wikiwand.com/en/List_of_countries_and_dependencies_by_population"</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</pre></div>
<p>Now that I think about it, maybe it takes some time for the javascript to render so you need to have a pause, especially if the internet connection is acting up.</p>
<div class="highlight">
<pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">by_population</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">by_population</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Rank</th>
<th class="org-left" scope="col">Country(or dependent territory)</th>
<th class="org-right" scope="col">Population</th>
<th class="org-right" scope="col">% of world</th>
<th class="org-left" scope="col">Date</th>
<th class="org-left" scope="col">Source(official or UN)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">China[b]</td>
<td class="org-right">1404513080</td>
<td class="org-right">nan</td>
<td class="org-left">20 Sep 2020</td>
<td class="org-left">National population clock[3]</td>
</tr>
</tbody>
</table>
<p>Pandas doesn't seem to be able to handle the "% of world" column - probably because they put the percent symbol in the rows for some reason.</p>
<div class="highlight">
<pre><span></span><span class="n">population_2</span> <span class="o">=</span> <span class="n">by_population</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{world[Columns.population] - population_2:,}"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{cleaned[Columns.population].sum() - population_2:,}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
-7,693,448,437
-7,861,884,121
</pre>
<p>What?</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{population_2:,}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
15,507,529,605
</pre>
<p>According to the Wikipedia page the world population is 7,814,267,000 - so something isn't right here.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">by_population</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">))</span>
</pre></div>
<pre class="example">
242
252
</pre>
<p>They also don't have the same number of countries (it should be off by 1 because of Antarctica, not by 10).</p>
<div class="highlight">
<pre><span></span><span class="n">countries</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cleaned</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">])</span>

<span class="c1"># the new table doesn't have a space between Country and the parenthesis</span>
<span class="n">countries_2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">by_population</span><span class="p">[</span><span class="s2">"Country(or dependent territory)"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">countries</span> <span class="o">-</span> <span class="n">countries_2</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">countries_2</span> <span class="o">-</span> <span class="n">countries</span><span class="p">)</span>
</pre></div>
<pre class="example">
{'Northern Cyprus[note 4]', 'Western Sahara[note 12]', 'Taiwan', 'British Virgin Islands (United Kingdom)', 'Morocco', 'Bonaire (Netherlands)', 'Jersey (United Kingdom)', 'Cyprus', 'Anguilla (United Kingdom)', 'Isle of Man (United Kingdom)', 'Russia[note 11]', 'Wallis & Futuna (France)', 'Saba (Netherlands)', 'United States', 'Transnistria[note 3]', 'Vatican City[note 1]', 'Somaliland[note 8]', 'United States Virgin Islands (United States)', 'France', 'Turks and Caicos Islands (United Kingdom)', 'Cook Islands (New Zealand)', 'Democratic Republic of the Congo', 'Mayotte (France)', 'Tanzania', 'China', 'Guam (United States)', 'Falkland Islands (United Kingdom)', 'Guernsey (United Kingdom)', 'Northern Mariana Islands (United States)', 'Netherlands', 'Serbia', 'Republic of the Congo', 'Pitcairn Islands (United Kingdom)', 'Timor-Leste', 'Kosovo[note 2]', 'Eswatini (Swaziland)', 'Niue (New Zealand)', 'Denmark', 'Gibraltar (United Kingdom)', 'Saint Helena, Ascension and Tristan da Cunha (United Kingdom)', 'Finland', 'Pakistan', 'American Samoa (United States)', 'Sint Eustatius (Netherlands)', 'Bermuda (United Kingdom)', 'India', 'Abkhazia[note 6]', 'United Kingdom', 'Cayman Islands (United Kingdom)', 'Puerto Rico (United States)', 'Moldova', 'French Guiana (France)', 'South Ossetia[note 9]', 'Guadeloupe (France)', 'Ukraine [note 5]', 'Georgia', 'Svalbard and Jan Mayen (Norway)', 'Somalia', 'Tokelau (New Zealand)', 'Réunion (France)', 'Uruguay[note 7][clarification needed]', 'Martinique (France)', 'Federated States of Micronesia', 'Montserrat (United Kingdom)', 'Artsakh[note 10]', 'Antarctica'}

{'Pakistan[e]', 'India[c]', 'DR Congo', 'Falkland Islands (UK)', 'United Kingdom[h]', 'Wallis and Futuna (France)', 'Puerto Rico (US)', 'East Timor', 'Republic of Artsakh[z]', 'China[b]', 'Taiwan[l]', 'South Ossetia[aa]', 'Tokelau (NZ)', 'World', 'Ukraine[j]', 'Netherlands[m]', 'Saint Helena, Ascensionand Tristan da Cunha (UK)', 'American Samoa (US)', 'Tanzania[i]', 'Finland[q]', 'Vatican City[ab]', 'U.S. Virgin Islands (US)', 'Morocco[k]', 'Transnistria[w]', 'Somalia[n]', 'Abkhazia[y]', 'Cayman Islands (UK)', 'Gibraltar (UK)', 'Serbia[o]', 'Uruguay', 'Cook Islands (NZ)', 'Northern Cyprus[x]', 'Eswatini', 'Guernsey (UK)', 'Congo', 'Russia[f]', 'Bermuda (UK)', 'Pitcairn Islands (UK)', 'Guam (US)', 'Montserrat (UK)', 'Moldova[s]', 'Kosovo[t]', 'Denmark[p]', 'Jersey (UK)', 'France[g]', 'Isle of Man (UK)', 'Cyprus[u]', 'Anguilla (UK)', 'Georgia[r]', 'Western Sahara[v]', 'Northern Mariana Islands (US)', 'F.S. Micronesia', 'United States[d]', 'Turks and Caicos Islands (UK)', 'Niue (NZ)', 'British Virgin Islands (UK)'}
</pre>
<p>Some of that is just their notes being added, and an inconsistency of naming, e.g. United Kingdom vs UK. but the population only set also seems to break up things a little differently - they consider the countries within the Netherlands to be separate, for instance. This is messier than I thought, and I don't know how to reconcile the population explosion.</p>
<p>Okay, I just noticed something.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">by_population</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Rank</th>
<th class="org-left" scope="col">Country(or dependent territory)</th>
<th class="org-right" scope="col">Population</th>
<th class="org-right" scope="col">% of world</th>
<th class="org-left" scope="col">Date</th>
<th class="org-left" scope="col">Source(official or UN)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">nan</td>
<td class="org-left">World</td>
<td class="org-right">7814267000</td>
<td class="org-right">100%</td>
<td class="org-left">19 Sep 2020</td>
<td class="org-left">UN Projection[202]</td>
</tr>
</tbody>
</table>
<p>They copied the header here too, but pandas was able to parse the numbers (probably because the headers only have one row).</p>
<div class="highlight">
<pre><span></span><span class="n">world_2</span> <span class="o">=</span> <span class="n">by_population</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">by_population</span> <span class="o">=</span> <span class="n">by_population</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">population_2</span> <span class="o">=</span> <span class="n">by_population</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{world[Columns.population] - population_2:,}"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{cleaned[Columns.population].sum() - population_2:,}"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{population_2:,}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
121,019,395
-47,416,289
7,693,262,605
</pre>
<p>The second table is short too, but it still has more than the original table… Maybe I just don't care about the numbers, as long as they're rankable. Although the fact that the tables have different numbers of countries isn't reassuring…</p>
<p>I think I'll see if making a combined table myself would be better. But first let's see what percentage of the population is missing.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"By Population Table: {(by_population.Population/world_2.Population).sum() * 100:0.2f} %"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"By Density Table: {(cleaned.Population/world_2.Population).sum() * 100:0.2f} %"</span><span class="p">)</span>
</pre></div>
<pre class="example">
By Population Table: 98.45 %
By Density Table: 97.84 %
</pre></div>
</div>
<div class="outline-3" id="outline-container-org33d54aa">
<h3 id="org33d54aa">Countries by Area</h3>
<div class="outline-text-3" id="text-org33d54aa">
<div class="highlight">
<pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s2">"https://www.wikiwand.com/en/List_of_countries_and_dependencies_by_area"</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">by_area</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">by_area</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Rank</th>
<th class="org-left" scope="col">Country / Dependency</th>
<th class="org-left" scope="col">Total in km2 (mi2)</th>
<th class="org-left" scope="col">Land in km2 (mi2)</th>
<th class="org-left" scope="col">Water in km2 (mi2)</th>
<th class="org-right" scope="col">% water</th>
<th class="org-right" scope="col">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">nan</td>
<td class="org-left">World</td>
<td class="org-left">510,072,000 (196,940,000)</td>
<td class="org-left">148,940,000 (57,510,000)</td>
<td class="org-left">361,132,000 (139,434,000)</td>
<td class="org-right">70.8</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>
<p>So once again we have a summation in there, but we have a bigger problem in that they combine the units in the same columns…</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">by_area</span><span class="p">))</span>
</pre></div>
<pre class="example">
264
</pre>
<p>Okay, so now we have another problem in that all three sets have differing numbers of entries. I'm guessing that trying to reconcile the country names is going to be a nightmare so I think I'll have to stick with the original table. I just looked at the Wikipedia page and this table includes "unrecognized states" which is probably why it has more countries. Maybe it's these unrecognized states that makes up the shortcoming in the population and area. Maybe.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org3095031">
<h2 id="org3095031">Plotting Again</h2>
<div class="outline-text-2" id="text-org3095031"></div>
<div class="outline-3" id="outline-container-org77b2155">
<h3 id="org77b2155">By Area</h3>
<div class="outline-text-3" id="text-org77b2155"></div>
<div class="outline-4" id="outline-container-orgb406d0a">
<h4 id="orgb406d0a">Biggest</h4>
<div class="outline-text-4" id="text-orgb406d0a">
<div class="highlight">
<pre><span></span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">)</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span>
                          <span class="n">hover_cols</span><span class="o">=</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">,</span>
                                      <span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">])</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                                          <span class="n">title</span><span class="o">=</span><span class="s2">"Top Ten Countries by Area"</span><span class="p">,</span>
                                          <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                                          <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                                          <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
                                          <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
                                          <span class="n">xrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"top_ten_countries_by_area_cleaned"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/wikipedia-list-of-countries/top_ten_countries_by_area_cleaned.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Okay, so it looks like I forgot to clean out the note references in the country names. Also, Russia as bigger than Antarctica? Go figure. I'm also surprised that the United States has more area than China. Actually I was surprised by this whole thing. I guess I never really looked too closely at the relative sizes of countries before, and area's a tough thing to estimate visually.</p>
</div>
</div>
<div class="outline-4" id="outline-container-orgd858902">
<h4 id="orgd858902">Getting Rid of the Notes</h4>
<div class="outline-text-4" id="text-orgd858902">
<div class="highlight">
<pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">cleaned</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"["</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cleaned</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org1dde8b4">
<h4 id="org1dde8b4">Smallest</h4>
<div class="outline-text-4" id="text-org1dde8b4">
<div class="highlight">
<pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Bottom Ten Countries by Area"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"bottom_ten_countries_by_area_cleaned"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/wikipedia-list-of-countries/bottom_ten_countries_by_area_cleaned.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgb0feab6">
<h3 id="orgb0feab6">By Population</h3>
<div class="outline-text-3" id="text-orgb0feab6"></div>
<div class="outline-4" id="outline-container-orgc543271">
<h4 id="orgc543271">Most Populated</h4>
<div class="outline-text-4" id="text-orgc543271">
<div class="highlight">
<pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">population_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span>
                      <span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">,</span>
                          <span class="n">hover_cols</span><span class="o">=</span><span class="n">population_columns</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                                          <span class="n">title</span><span class="o">=</span><span class="s2">"Top Ten Countries by Population"</span><span class="p">,</span>
                                          <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                                          <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                                          <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
                                          <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
                                          <span class="n">xrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"top_ten_countries_by_population"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/wikipedia-list-of-countries/top_ten_countries_by_population.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>I had encountered this list before, when reading <i>Memory Craft</i> by Lynne Kelly, but it still surprises me that the United States is third and that Bangladesh has more people than Russia.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org7065ff2">
<h4 id="org7065ff2">Least Populous</h4>
<div class="outline-text-4" id="text-org7065ff2">
<div class="highlight">
<pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">,</span>
                          <span class="n">hover_cols</span><span class="o">=</span><span class="n">population_columns</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                              <span class="n">title</span><span class="o">=</span><span class="s2">"Bottom Ten Countries by Population"</span><span class="p">,</span>
                              <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                              <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                              <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
                              <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"bottom_ten_countries_by_population"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/wikipedia-list-of-countries/bottom_ten_countries_by_population.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
</div>
<div class="outline-3" id="outline-container-org2120292">
<h3 id="org2120292">By Density</h3>
<div class="outline-text-3" id="text-org2120292"></div>
<div class="outline-4" id="outline-container-orga20b554">
<h4 id="orga20b554">Densest</h4>
<div class="outline-text-4" id="text-orga20b554">
<div class="highlight">
<pre><span></span><span class="n">density_columns</span><span class="o">=</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">population</span><span class="p">,</span> <span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">]</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">,</span>
                          <span class="n">hover_cols</span><span class="o">=</span><span class="n">density_columns</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                              <span class="n">title</span><span class="o">=</span><span class="s2">"Top Ten Countries by Population Density"</span><span class="p">,</span>
                              <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                              <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                              <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
                              <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"top_ten_countries_by_population_density"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/wikipedia-list-of-countries/top_ten_countries_by_population_density.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>It's sort of interesting that the two most dense countries are both known for their gambling.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org12cd772">
<h4 id="org12cd772">Sparsest</h4>
<div class="outline-text-4" id="text-org12cd772">
<p>First, because of the way I calculated Antartica it currently has a negative number (-14) for density, which is a little odd so I'll set it to 0.</p>
<div class="highlight">
<pre><span></span><span class="n">cleaned</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cleaned</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">]</span><span class="o">==</span><span class="s2">"Antarctica"</span><span class="p">,</span> <span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">country_cleaned</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">density_cleaned</span><span class="p">,</span>
                          <span class="n">hover_cols</span><span class="o">=</span><span class="n">density_columns</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                              <span class="n">title</span><span class="o">=</span><span class="s2">"Bottom Ten Countries by Population Density"</span><span class="p">,</span>
                              <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                              <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                              <span class="n">fontscale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                              <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
                              <span class="n">yrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"bottom_ten_countries_by_population_density"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/wikipedia-list-of-countries/bottom_ten_countries_by_population_density.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org29a3271">
<h2 id="org29a3271">End</h2>
<div class="outline-text-2" id="text-org29a3271">
<p>Well, the point wasn't really just to look at the list (there is a Wikipedia page there already, after all) but to have something that I could mess with locally, so I'll save it now, but first I'll do a little more cleaning.</p>
<p>Do I need the rank? Nah.</p>
<div class="highlight">
<pre><span></span><span class="k">del</span><span class="p">(</span><span class="n">cleaned</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">rank</span><span class="p">])</span>
</pre></div>
<p>I was going to remove the density and re-calculate it but for some reason they don't differ that much, but it might make a difference in the rankings for less dense countries so I'll keep the original column.</p>
<p>Since I'm going to save it to a csv I'll parse the date first.</p>
<div class="highlight">
<pre><span></span><span class="n">cleaned</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">cleaned</span><span class="p">[</span><span class="n">Columns</span><span class="o">.</span><span class="n">date</span><span class="p">])</span>
</pre></div>
<p>Even though the table is meant for population density I think I'll save it sorted by area.</p>
<div class="highlight">
<pre><span></span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">Columns</span><span class="o">.</span><span class="n">area_cleaned</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
<p>And now to save it.</p>
<div class="highlight">
<pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"apeiron/wikipedia"</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span>
<span class="n">cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">"countries-by-area-population-density.csv"</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/in-the-land-before-the-monkey/">In the time of Boar and Monkey</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/in-the-land-before-the-monkey/" rel="bookmark"><time class="published dt-published" datetime="2020-09-09T13:12:13-07:00" itemprop="datePublished" title="2020-09-09 13:12">2020-09-09 13:12</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<p class="verse">In the time of boar and Monkey,<br>
When Death became a painter,<br>
Love forgot its mother's name,<br>
And new memories burn fainter.<br>
<br>
Sitting on the front porch,<br>
Eating screaming greens,<br>
We sang a song of six-fingers,<br>
In unkown Cantonese.<br>
<br>
Down on the mountain,<br>
Riding to the Top,<br>
Father rode side-saddle,<br>
The Other rode to crop.<br>
<br>
Covid came for cannabis,<br>
And stayed around for meth,<br>
Our planet burned around us,<br>
While Juniors breathed out death.<br>
<br>
The rage didn't kill us,<br>
It had no monopoly,<br>
I watched it all through opaque glass,<br>
Looking out for me.<br>
<br>
Still the Rabbit sits backwards-look-away<br>
Muttering her grumbles,<br>
Through her dark of day,<br>
And the Spiders sing around my head -<br>
"We will never go away."<br></p>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/they-say-exercises/">They Say: Exercises</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/they-say-exercises/" rel="bookmark"><time class="published dt-published" datetime="2020-09-05T18:17:45-07:00" itemprop="datePublished" title="2020-09-05 18:17">2020-09-05 18:17</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/they-say-exercises/#orgaf9bed6">Add They Say</a>
<ul>
<li><a href="posts/they-say-exercises/#org0c41af0">Poisoned Water</a></li>
<li><a href="posts/they-say-exercises/#org71699c9">Fabricated History</a></li>
<li><a href="posts/they-say-exercises/#orgc4b552a">Rational Freud</a></li>
<li><a href="posts/they-say-exercises/#orgbf1cde7">Male Dominance</a></li>
<li><a href="posts/they-say-exercises/#org1374749">Filmed Romance</a></li>
<li><a href="posts/they-say-exercises/#org0b92abd">Stifled Creativity</a></li>
</ul>
</li>
<li><a href="posts/they-say-exercises/#org971500a">Zinczenko's Way</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgaf9bed6">
<h2 id="orgaf9bed6">Add They Say</h2>
<div class="outline-text-2" id="text-orgaf9bed6"></div>
<div class="outline-3" id="outline-container-org0c41af0">
<h3 id="org0c41af0">Poisoned Water</h3>
<div class="outline-text-3" id="text-org0c41af0">
<blockquote>
<p>Our experiments suggest that there are dangerous levels of chemical X in the Ohio groundwater.</p>
</blockquote>
<blockquote>
<p>Many people assume that Ohio's water is safe and healthy to drink, but our experiments suggest that there are dangerous levels of chemical X in the Ohio groundwater.</p>
</blockquote>
</div>
</div>
<div class="outline-3" id="outline-container-org71699c9">
<h3 id="org71699c9">Fabricated History</h3>
<div class="outline-text-3" id="text-org71699c9">
<blockquote>
<p>Material forces drive history.</p>
</blockquote>
<blockquote>
<p>It is often said that our destiny is up to Fate, when really material forces drive history.</p>
</blockquote>
</div>
</div>
<div class="outline-3" id="outline-container-orgc4b552a">
<h3 id="orgc4b552a">Rational Freud</h3>
<div class="outline-text-3" id="text-orgc4b552a">
<blockquote>
<p>Proponents of Freudian psychology question standard notions of "rationality".</p>
</blockquote>
<blockquote>
<p>You would think that psychologists would agree on something as fundamental as what rationality is, but proponents of Freudian psychology question standard notions of "rationality".</p>
</blockquote>
</div>
</div>
<div class="outline-3" id="outline-container-orgbf1cde7">
<h3 id="orgbf1cde7">Male Dominance</h3>
<div class="outline-text-3" id="text-orgbf1cde7">
<blockquote>
<p>Male students often dominate class discussions.</p>
</blockquote>
<blockquote>
<p>Common sense seems to dictate that the academic world would be a place where diversity of opinion and gender equity would be encouraged, but in reality male students often dominate class discussions.</p>
</blockquote>
</div>
</div>
<div class="outline-3" id="outline-container-org1374749">
<h3 id="org1374749">Filmed Romance</h3>
<div class="outline-text-3" id="text-org1374749">
<blockquote>
<p>The film is about the problems of romantic relationships.</p>
</blockquote>
<blockquote>
<p>People often assume that <i>King Kong</i> is a monster movie when actually the film is about the problems of romantic relationships.</p>
</blockquote>
</div>
</div>
<div class="outline-3" id="outline-container-org0b92abd">
<h3 id="org0b92abd">Stifled Creativity</h3>
<div class="outline-text-3" id="text-org0b92abd">
<blockquote>
<p>I'm afraid that templates like the ones in this book will stifle my creativity.</p>
</blockquote>
<blockquote>
<p>Graff and Birkenstein state that using their templates will encourage originality but I'm afraid that templates like the ones in this book will stifle my creativity.</p>
</blockquote>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org971500a">
<h2 id="org971500a">Zinczenko's Way</h2>
<div class="outline-text-2" id="text-org971500a">
<blockquote>
<p>If ever there was an idea custom-made for a Jay Leno monologue, this was it: <span class="underline">_. Isn't that like _</span>? Whatever happened to __?</p>
<p>I happen to sympathize with <span class="underline">_, though, perhaps because _</span>.</p>
</blockquote>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/they-say-i-say-introduction/">They Say, I Say Introduction: Exercises</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/they-say-i-say-introduction/" rel="bookmark"><time class="published dt-published" datetime="2020-09-05T11:45:56-07:00" itemprop="datePublished" title="2020-09-05 11:45">2020-09-05 11:45</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div class="outline-2" id="outline-container-orgcbe01c7">
<h2 id="orgcbe01c7">Exercise 1: Fill in the Blanks</h2>
<div class="outline-text-2" id="text-orgcbe01c7">
<p>In the Introduction to <i>"They Say/I Say": The Moves That Matter in Academic Writing</i>, Gerald Graff and Cathy Birkenstein provide templates designed to <i>provide students with a structure for arguments so that they can learn the basic forms that experienced writers instinctually use</i>. Specifically, Graff and Birkenstein argue that the types of writing templates they offer <i>demonstrate the basic forms of argument in order to free the student to be creative while working within those forms</i>. As the authors themselves put it, <i>"Even the most avant-garde, cutting-edge artists like improvisational jazz musicians need to master the basic forms that their work improvises on, departs from, and goes beyond, or else their work will come across as uneducated child's play."</i> Although some people believe <i>the use of templates will stifle the writer's originality</i>, Graff and Birkenstein insist that <i>using the templates will make writing more original rather than less</i>. In sum, then, their view is that <i>writers need to learn the underlying structure of argument and templates provide the best way to do so</i>.</p>
<p>I <i>am optimistic that the authors are correct</i>. I my view, the types of templates that the authors recommend <i>are useful in both providing a prompt for the writer and a scaffolding that keeps the inexperienced writer from feeling lost</i> . For instance, <i>this exercise forces you to summarize the authors' intent in using templates as well as provide a quote, which I likely would not have done otherwise</i>. In addition, <i>because the basic sentences are pre-ordained, I didn't have to spend time worrying about form and style</i>. Some might object, of course, on the grounds that <i>simply filling in blanks is not the same thing as writing coherent sentences and paragraphs entirely from scratch</i>. Yet I would argue that <i>one has to learn to walk before learning to run, and while attempting to only use templates might prove stifling eventually, they are a valid way to start</i>. Overall, then, I believe <i>the use of templates can work as prompts to teach the structure of argument and, perhaps more importantly, to generate writing and thinking</i> - an important point to make given <i>the need to make our thoughts both heard and understood by others in an ever more polarized world</i>.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org7895153">
<h2 id="org7895153">Exercise 2: Roll Your Own Template</h2>
<div class="outline-text-2" id="text-org7895153"></div>
<div class="outline-3" id="outline-container-org733358f">
<h3 id="org733358f">Template Source</h3>
<div class="outline-text-3" id="text-org733358f">
<p>An essay by Emily Poe, then a student at Furman University.</p>
<blockquote>
<p>The term “vegetarian” tends to be synonymous with “tree-hugger” in many people’s minds. <i>They see</i> vegetarianism as a cult that brainwashes its followers into eliminating an essential part of their daily diets for an abstract goal of “animal welfare.” <i>However</i>, few vegetarians choose their lifestyle just to follow the crowd. <i>On the contrary</i>, many of these supposedly brainwashed people are actually independent thinkers, concerned citizens, and compassionate human beings. <i>For the truth</i> is that there are many very good reasons for giving up meat. Perhaps the best reasons are to improve the environment, to encourage humane treatment of livestock, or to enhance one’s own health. <i>In this essay</i>, then, closely examining a vegetarian diet as compared to a meat-eater’s diet will show that vegetarianism is clearly the better option for sustaining the Earth and all its inhabitants.</p>
</blockquote>
</div>
</div>
<div class="outline-3" id="outline-container-org52fd669">
<h3 id="org52fd669">Fill in the Blanks</h3>
<div class="outline-text-3" id="text-org52fd669">
<p>&lt;thesis&gt;. <i>They see</i> &lt;something&gt;. <i>However</i>, &lt;this is not so&gt;. <i>On the contrary</i>, &lt;instead&gt;. <i>For the truth</i> &lt;&gt;. <i>Perhaps the best reasons are</i> &lt;&gt;. <i>In this essay</i>, &lt;this is what I'll show&gt;.</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/pulling-top-100-names/">Pulling Top Names From the Past 100 Years</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/pulling-top-100-names/" rel="bookmark"><time class="published dt-published" datetime="2020-08-18T17:33:38-07:00" itemprop="datePublished" title="2020-08-18 17:33">2020-08-18 17:33</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/pulling-top-100-names/#org0a7ff88">Beginning</a>
<ul>
<li><a href="posts/pulling-top-100-names/#org8455b51">Set Up</a></li>
</ul>
</li>
<li><a href="posts/pulling-top-100-names/#orge277003">Middle</a>
<ul>
<li><a href="posts/pulling-top-100-names/#orgfcf65cd">Pulling the Table</a></li>
<li><a href="posts/pulling-top-100-names/#orgc8094a9">Cleaning Up the Table</a></li>
<li><a href="posts/pulling-top-100-names/#org4e29bad">Some Plotting</a></li>
</ul>
</li>
<li><a href="posts/pulling-top-100-names/#org22991e7">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org0a7ff88">
<h2 id="org0a7ff88">Beginning</h2>
<div class="outline-text-2" id="text-org0a7ff88"></div>
<div class="outline-3" id="outline-container-org8455b51">
<h3 id="org8455b51">Set Up</h3>
<div class="outline-text-3" id="text-org8455b51"></div>
<div class="outline-4" id="outline-container-org290aa13">
<h4 id="org290aa13">Imports</h4>
<div class="outline-text-4" id="text-org290aa13">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="c1"># pypi</span>
<span class="kn">import</span> <span class="nn">hvplot.pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">EmbedHoloviews</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgdaa1a84">
<h4 id="orgdaa1a84">Plotting</h4>
<div class="outline-text-4" id="text-orgdaa1a84">
<div class="highlight">
<pre><span></span><span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"pulling-top-100-names"</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedHoloviews</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="n">f</span><span class="s2">"files/posts/{SLUG}"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orge277003">
<h2 id="orge277003">Middle</h2>
<div class="outline-text-2" id="text-orge277003"></div>
<div class="outline-3" id="outline-container-orgfcf65cd">
<h3 id="orgfcf65cd">Pulling the Table</h3>
<div class="outline-text-3" id="text-orgfcf65cd"></div>
<div class="outline-4" id="outline-container-orgaeb94c1">
<h4 id="orgaeb94c1">Trying a Naive Request</h4>
<div class="outline-text-4" id="text-orgaeb94c1">
<div class="highlight">
<pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s2">"https://www.ssa.gov/OACT/babynames/decades/century.html"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">))</span>
</pre></div>
<pre class="example">
1
</pre>
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
<pre class="example">
  Unnamed: 0_level_0  Males          Females         
                Rank   Name   Number    Name   Number
0                1.0  James  4764644    Mary  3328565
</pre>
<p>So it looks like it's a plain table so we don't need Selenium or something else to render javascript, but the header is a little messed up.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc8094a9">
<h3 id="orgc8094a9">Cleaning Up the Table</h3>
<div class="outline-text-3" id="text-orgc8094a9">
<div class="highlight">
<pre><span></span><span class="n">males</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">females</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span>
<span class="k">print</span><span class="p">(</span><span class="n">males</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
<pre class="example">
   Males         
    Name   Number
0  James  4764644
</pre></div>
<div class="outline-4" id="outline-container-org86e9ff8">
<h4 id="org86e9ff8">The Last Row</h4>
<div class="outline-text-4" id="text-org86e9ff8">
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">males</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
<pre class="example">
Males  Name      Source: 100% sample based on Social Security c...
       Number    Source: 100% sample based on Social Security c...
Name: 100, dtype: object
</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
<pre class="example">
Source: 100% sample based on Social Security card application data as of of March 2019. See the limitations of  this data source.
</pre>
<p>That's interesting, but it doesn't help with what I want, which is just the names.</p>
<div class="highlight">
<pre><span></span><span class="n">males</span> <span class="o">=</span> <span class="n">males</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">females</span> <span class="o">=</span> <span class="n">females</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">males</span><span class="p">)</span> <span class="o">==</span> <span class="mi">100</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">females</span><span class="p">)</span> <span class="o">==</span> <span class="mi">100</span>
<span class="k">print</span><span class="p">(</span><span class="n">females</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
<pre class="example">
  Females         
     Name   Number
0    Mary  3328565
</pre>
<p>So, now to re-add the rank and add gender columns so the multi-level column headers can be re-done.</p>
<div class="highlight">
<pre><span></span><span class="n">males</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">,</span> <span class="s2">"count"</span><span class="p">]</span>
<span class="n">females</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">,</span> <span class="s2">"count"</span><span class="p">]</span>
<span class="n">males</span><span class="p">[</span><span class="s2">"gender"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"male"</span>
<span class="n">females</span><span class="p">[</span><span class="s2">"gender"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"female"</span>

<span class="n">males</span><span class="p">[</span><span class="s2">"rank"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>
<span class="n">females</span><span class="p">[</span><span class="s2">"rank"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">males</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
<pre class="example">
    name    count gender  rank
0  James  4764644   male     1
</pre>
<p>Now to re-combine them.</p>
<div class="highlight">
<pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">males</span><span class="p">,</span> <span class="n">females</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org4e29bad">
<h3 id="org4e29bad">Some Plotting</h3>
<div class="outline-text-3" id="text-org4e29bad">
<p>Before we can plot them we have to change the <code>count</code> column to be (you guessed it) a number since that last row with the source information prevents pandas' ability to convert the column itself.</p>
<div class="highlight">
<pre><span></span><span class="n">names</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">"count"</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="s2">"count"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"rank"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"count"</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">"gender"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Top Male and Female Names of the Last 100 Years"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">990</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">780</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"gender_plot"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="posts/pulling-top-100-names/gender_plot.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Well, pretend that you don't see the x-ticks… It's interesting that the highest ranked male names have a higher count than the highest ranked female names.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org22991e7">
<h2 id="org22991e7">End</h2>
<div class="outline-text-2" id="text-org22991e7">
<p>Time to save the table.</p>
<div class="highlight">
<pre><span></span><span class="n">names</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"apeiron/top_100_ssa_names.csv"</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/pulling-legendary-creatures-from-wikipedia/">Pulling Legendary Creatures From Wikipedia</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/pulling-legendary-creatures-from-wikipedia/" rel="bookmark"><time class="published dt-published" datetime="2020-08-06T15:04:35-07:00" itemprop="datePublished" title="2020-08-06 15:04">2020-08-06 15:04</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/pulling-legendary-creatures-from-wikipedia/#orga9787b2">Beginning</a>
<ul>
<li><a href="posts/pulling-legendary-creatures-from-wikipedia/#org250d407">Set Up</a></li>
</ul>
</li>
<li><a href="posts/pulling-legendary-creatures-from-wikipedia/#org7952006">Middle</a>
<ul>
<li><a href="posts/pulling-legendary-creatures-from-wikipedia/#org48d3e32">Grab the Page and Make Some Soup</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orga9787b2">
<h2 id="orga9787b2">Beginning</h2>
<div class="outline-text-2" id="text-orga9787b2"></div>
<div class="outline-3" id="outline-container-org250d407">
<h3 id="org250d407">Set Up</h3>
<div class="outline-text-3" id="text-org250d407"></div>
<div class="outline-4" id="outline-container-orgb8edab4">
<h4 id="orgb8edab4">Imports</h4>
<div class="outline-text-4" id="text-orgb8edab4">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">argparse</span> <span class="kn">import</span> <span class="n">Namespace</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span><span class="p">,</span> <span class="n">UnicodeDammit</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org8fc7cc2">
<h4 id="org8fc7cc2">Tabulate</h4>
<div class="outline-text-4" id="text-org8fc7cc2">
<div class="highlight">
<pre><span></span><span class="n">TABLE</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">tabulate</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">,</span> <span class="n">showindex</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgd38f465">
<h4 id="orgd38f465">Selenium</h4>
<div class="outline-text-4" id="text-orgd38f465">
<p>I'll use a headless instance of selenium-firefox to grab and render the wikipedia page.</p>
<div class="highlight">
<pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">FirefoxOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">headless</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">(</span><span class="n">firefox_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org7952006">
<h2 id="org7952006">Middle</h2>
<div class="outline-text-2" id="text-org7952006"></div>
<div class="outline-3" id="outline-container-org48d3e32">
<h3 id="org48d3e32">Grab the Page and Make Some Soup</h3>
<div class="outline-text-3" id="text-org48d3e32">
<div class="highlight">
<pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s2">"https://en.wikipedia.org/wiki/List_of_legendary_creatures_by_type"</span>

<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</pre></div>
<p>This page is a little odd in that it uses tables but the tables then contain unordered lists which seem to give pandas a hard time, so I'll have to poke around a little bit using Beautiful Soup first to figure it out.</p>
<div class="highlight">
<pre><span></span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">)</span>
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgb1748d0">
<h4 id="orgb1748d0">Looking at the Headings</h4>
<div class="outline-text-4" id="text-orgb1748d0">
<p>The level-2 headlines describe different ways to catalog the creatures, in addition they have "span" tags within them that have the "mw-class" associated with them so we can grab those tags using Beautiful Soup's <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#css-selectors">select</a> method, which uses CSS selectors.</p>
<div class="highlight">
<pre><span></span><span class="n">headlines</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">"h2 span.mw-headline"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">headline</span> <span class="ow">in</span> <span class="n">headlines</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">" - {headline}"</span><span class="p">)</span>
</pre></div>
<ul class="org-ul">
<li>&lt;span class="mw-headline" id="Animals,_creatures_associated_with"&gt;Animals, creatures associated with&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Artificial_creatures"&gt;Artificial creatures&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Body_parts,_creatures_associated_with"&gt;Body parts, creatures associated with&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Concepts,_creatures_associated_with"&gt;Concepts, creatures associated with&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Demons"&gt;Demons&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Elements,_creatures_associated_with"&gt;Elements, creatures associated with&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Habitats,_creatures_associated_with"&gt;Habitats, creatures associated with&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Humanoids"&gt;Humanoids&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Hybrids"&gt;Hybrids&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Astronomical_objects,_creatures_associated_with"&gt;Astronomical objects, creatures associated with&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="World"&gt;World&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Creatures_associated_with_Plants"&gt;Creatures associated with Plants&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Shapeshifters"&gt;Shapeshifters&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Creatures_associated_with_Times"&gt;Creatures associated with Times&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Undead"&gt;Undead&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="Miscellaneous"&gt;Miscellaneous&lt;/span&gt;</li>
<li>&lt;span class="mw-headline" id="References"&gt;References&lt;/span&gt;</li>
</ul>
<p>We don't need references, but the other headlines might be helpful in categorizing these animals. Unfortunately the headings are above the sections with the stuff we want - they aren't parents of the sections so to get the actual parts we're going to need to do something else.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org12cdc41">
<h4 id="org12cdc41">Tables</h4>
<div class="outline-text-4" id="text-org12cdc41">
<p>I'll grab all the tables then filter out the ones I don't want - the first three tables are admonitions that the page might not be up to snuff and the last four are references and links to other pages.</p>
<div class="highlight">
<pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"table"</span><span class="p">)</span>
<span class="n">tables</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org2b5e8d5">
<h4 id="org2b5e8d5">The Table-Indices</h4>
<div class="outline-text-4" id="text-org2b5e8d5">
<div class="highlight">
<pre><span></span><span class="n">Table</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span>
    <span class="n">aquatic</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">arthropods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">bears</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgfdf0b12">
<h4 id="orgfdf0b12">Animals Associated With</h4>
<div class="outline-text-4" id="text-orgfdf0b12"></div>
<ul class="org-ul">
<li><a id="org27ddb6f"></a>Aquatic and Marine Animals<br>
<div class="outline-text-5" id="text-org27ddb6f">
<div class="highlight">
<pre><span></span><span class="n">PATTERN</span> <span class="o">=</span> <span class="s2">"\w+"</span>
<span class="n">WEIRD</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\xa0</span><span class="s2">"</span>
<span class="n">ERASE</span> <span class="o">=</span> <span class="s2">""</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="n">Table</span><span class="o">.</span><span class="n">aquatic</span><span class="p">]</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">)</span>
<span class="n">DASH</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
<span class="n">animals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">origin</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">description</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">WEIRD</span><span class="p">,</span> <span class="n">ERASE</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">DASH</span><span class="p">,</span> <span class="n">ERASE</span><span class="p">)</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" ("</span><span class="p">)</span>
    <span class="n">two_tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">")"</span><span class="p">)</span>
    <span class="n">animals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">origin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">two_tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">description</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">two_tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="n">beasts</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">animal</span><span class="o">=</span><span class="n">animals</span><span class="p">,</span>
    <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">))</span>
<span class="n">beasts</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Aquatic"</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">beasts</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">animal</th>
<th class="org-left" scope="col">origin</th>
<th class="org-left" scope="col">description</th>
<th class="org-left" scope="col">type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Bake-kujira</td>
<td class="org-left">Japanese</td>
<td class="org-left">ghost whale</td>
<td class="org-left">Aquatic</td>
</tr>
<tr>
<td class="org-left">Ceffyl Dŵr</td>
<td class="org-left">Welsh</td>
<td class="org-left">water horse</td>
<td class="org-left">Aquatic</td>
</tr>
<tr>
<td class="org-left">Encantado</td>
<td class="org-left">Brazil</td>
<td class="org-left">shapeshifting trickster dolphins</td>
<td class="org-left">Aquatic</td>
</tr>
<tr>
<td class="org-left">Kelpie</td>
<td class="org-left">Scottish</td>
<td class="org-left">water horse</td>
<td class="org-left">Aquatic</td>
</tr>
<tr>
<td class="org-left">Kushtaka</td>
<td class="org-left">Tlingit</td>
<td class="org-left">shapeshifting "land otter man"</td>
<td class="org-left">Aquatic</td>
</tr>
<tr>
<td class="org-left">Selkie</td>
<td class="org-left">Scottish</td>
<td class="org-left">shapeshifting seal people</td>
<td class="org-left">Aquatic</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><a id="orgda3aa6e"></a>Arthropods<br>
<div class="outline-text-5" id="text-orgda3aa6e">
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="n">Table</span><span class="o">.</span><span class="n">arthropods</span><span class="p">]</span>
<span class="n">animal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">origin</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">description</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">):</span>
    <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"("</span><span class="p">)</span>
    <span class="n">second</span><span class="p">,</span> <span class="n">third</span> <span class="o">=</span> <span class="n">last</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="s2">"{WEIRD}{DASH} "</span><span class="p">)</span>
    <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">")"</span><span class="p">,</span> <span class="n">ERASE</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">third</span> <span class="o">=</span> <span class="n">third</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">animal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
    <span class="n">origin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second</span><span class="p">)</span>
    <span class="n">description</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">third</span><span class="p">)</span>

<span class="n">to_append</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="nb">dict</span><span class="p">(</span>
        <span class="n">animal</span><span class="o">=</span><span class="n">animal</span><span class="p">,</span>
        <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">to_append</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Arthropod"</span>
<span class="n">beasts</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">beasts</span><span class="p">,</span> <span class="n">to_append</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">to_append</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">animal</th>
<th class="org-left" scope="col">origin</th>
<th class="org-left" scope="col">description</th>
<th class="org-left" scope="col">type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Anansi</td>
<td class="org-left">West African</td>
<td class="org-left">trickster spider</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Arachne</td>
<td class="org-left">Greek</td>
<td class="org-left">weaver cursed into a spider</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Khepri</td>
<td class="org-left">Ancient Egyptian</td>
<td class="org-left">beetle who pushes the sun</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Tsuchigumo</td>
<td class="org-left">Japanese</td>
<td class="org-left">shapeshifting giant spider</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Myrmecoleon</td>
<td class="org-left">Christian</td>
<td class="org-left">ant-lion</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Myrmidons</td>
<td class="org-left">Greek</td>
<td class="org-left">warriors created from ants by Zeus</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Jorōgumo</td>
<td class="org-left">Japanese</td>
<td class="org-left">ghost woman who shapeshifts into a spider</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Karkinos</td>
<td class="org-left">Greek</td>
<td class="org-left">Cancer the crab</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Mothman</td>
<td class="org-left">American cryptid</td>
<td class="org-left">man with moth wings and features</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Pabilsag</td>
<td class="org-left">Babylonian</td>
<td class="org-left">Sagittarius-like creature with scorpion tail</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Scorpion man</td>
<td class="org-left">Babylonian</td>
<td class="org-left">protector of travellers</td>
<td class="org-left">Arthropod</td>
</tr>
<tr>
<td class="org-left">Selket</td>
<td class="org-left">Ancient Egyptian</td>
<td class="org-left">scorpion death/healing goddess</td>
<td class="org-left">Arthropod</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><a id="org1c0761a"></a>Bears<br>
<div class="outline-text-5" id="text-org1c0761a">
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="n">Table</span><span class="o">.</span><span class="n">bears</span><span class="p">]</span>
<span class="n">animal</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"li"</span><span class="p">):</span>
    <span class="n">first</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"("</span><span class="p">)</span>
    <span class="n">second</span><span class="p">,</span> <span class="n">third</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="s2">"){WEIRD}{DASH} "</span><span class="p">)</span>
    <span class="n">animal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
    <span class="n">origin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second</span><span class="p">)</span>
    <span class="n">description</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">third</span><span class="p">)</span>
<span class="n">to_append</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">animal</span><span class="o">=</span><span class="n">animal</span><span class="p">,</span>
         <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
         <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">beasts</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">beasts</span><span class="p">,</span> <span class="n">to_append</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">to_append</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">animal</th>
<th class="org-left" scope="col">origin</th>
<th class="org-left" scope="col">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Bugbear</td>
<td class="org-left">Celtic</td>
<td class="org-left">child-eating hobgoblin</td>
</tr>
<tr>
<td class="org-left">Callisto</td>
<td class="org-left">Greek</td>
<td class="org-left">A nymph who was turned into a bear by Hera.</td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/pulling-a-list-of-animals-from-wikipedia/">Pulling A List of Animals From Wikipedia</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/pulling-a-list-of-animals-from-wikipedia/" rel="bookmark"><time class="published dt-published" datetime="2020-08-03T19:55:10-07:00" itemprop="datePublished" title="2020-08-03 19:55">2020-08-03 19:55</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#orgfee1af9">Beginning</a>
<ul>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#org13e1501">Set Up</a></li>
</ul>
</li>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#org184ad06">Middle</a>
<ul>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#org8a009eb">Grabbing Some HTML</a></li>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#org7a5fcd3">Building the Table</a></li>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#org7756a2e">Cleaning Up the Table</a></li>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#orgf0d95dc">Meats</a></li>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#org60be98d">Again, But With Soup This Time</a></li>
</ul>
</li>
<li><a href="posts/pulling-a-list-of-animals-from-wikipedia/#org94604aa">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgfee1af9">
<h2 id="orgfee1af9">Beginning</h2>
<div class="outline-text-2" id="text-orgfee1af9">
<p>As part of my pursuit of randomness I'm creating lists of things to select from. In this case I wanted a list of animals to create a <i>Visual Alphabet</i> and I decided to grab one from wikipedia. This is what I did.</p>
</div>
<div class="outline-3" id="outline-container-org13e1501">
<h3 id="org13e1501">Set Up</h3>
<div class="outline-text-3" id="text-org13e1501"></div>
<div class="outline-4" id="outline-container-orgcecc31d">
<h4 id="orgcecc31d">Imports</h4>
<div class="outline-text-4" id="text-orgcecc31d">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">ascii_uppercase</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">be_true</span><span class="p">,</span>
    <span class="n">expect</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org9e91d9c">
<h4 id="org9e91d9c">Set Up Tabulate</h4>
<div class="outline-text-4" id="text-org9e91d9c">
<p>This is just to make printing the pandas data-frames a little easier. <a href="https://github.com/nnicandro/emacs-jupyter">emacs-jupyter</a> actually does a pretty good job of rendering them as HTML like a regular jupyter notebook, but this makes it a little more readable while in emacs, plus I can control things better.</p>
<div class="highlight">
<pre><span></span><span class="n">TABLE</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">tabulate</span><span class="p">,</span> <span class="n">showindex</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org3e5013f">
<h4 id="org3e5013f">Set Up Selenium</h4>
<div class="outline-text-4" id="text-org3e5013f">
<p>I started this using Requests-HTML because wikipedia uses JQuery to render the tables and Requests-HTML it uses <a href="https://pyppeteer.github.io/pyppeteer/index.html">pyppeteer</a> to render javascript (as opposed to the reqular requests that just does an HTTP GET and so leaves the tables un-rendered). Unfortunately I can't get it to work in a jupyter notebook. One problem is that both jupyter and Requests-HTML use asyncio - using <a href="https://github.com/erdewit/nest_asyncio">nest_asyncio</a> allows pypeteer to run in the notebook but then I get this error:</p>
<div class="highlight">
<pre><span></span><span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">'coroutine'</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">'newPage'</span>
</pre></div>
<p>Which looks like it might be a pypeteer error, but tracking all this down is taking too long so I'm going to switch to using selenium. Since I'm running this on a remote machine we have to run it headless. I used to do this using <a href="https://www.wikiwand.com/en/Xvfb">XVFB</a> but selenium has a headless mode so I'll try that instead.</p>
<div class="highlight">
<pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">FirefoxOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">headless</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">(</span><span class="n">firefox_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org184ad06">
<h2 id="org184ad06">Middle</h2>
<div class="outline-text-2" id="text-org184ad06"></div>
<div class="outline-3" id="outline-container-org8a009eb">
<h3 id="org8a009eb">Grabbing Some HTML</h3>
<div class="outline-text-3" id="text-org8a009eb">
<p>Just let selenium render the JQuery tables for us.</p>
<div class="highlight">
<pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s2">"https://en.wikipedia.org/wiki/List_of_animal_names"</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org7a5fcd3">
<h3 id="org7a5fcd3">Building the Table</h3>
<div class="outline-text-3" id="text-org7a5fcd3">
<p>After giving up on Requests-HTML I was using <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#searching-the-tree">Beautiful Soup</a> to pull out the table so I could give it to pandas, but then I looked at the pandas documentation and it turns out they already do this, so you don't need to, but you do need to know how many tables there are and which one you want (it returns a list of dataframes). In this case I want the last one.</p>
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-right">
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">('Animal', 'A')</th>
<th class="org-left" scope="col">('Young', 'A')</th>
<th class="org-left" scope="col">('Female', 'A')</th>
<th class="org-left" scope="col">('Male', 'A')</th>
<th class="org-right" scope="col">('Collective noun', 'A')</th>
<th class="org-left" scope="col">('Collateral adjective', 'A')</th>
<th class="org-right" scope="col">('Culinary noun for meat', 'A')</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Aardvark</td>
<td class="org-left">cub</td>
<td class="org-left">sow</td>
<td class="org-left">boar</td>
<td class="org-right">nan</td>
<td class="org-left">orycteropodian</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>
<p>That's a little odd looking.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org7756a2e">
<h3 id="org7756a2e">Cleaning Up the Table</h3>
<div class="outline-text-3" id="text-org7756a2e">
<p>First, what's with all the <code>A</code> entries in the header?</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
<pre class="example">
MultiIndex([(                'Animal', 'A'),
            (                 'Young', 'A'),
            (                'Female', 'A'),
            (                  'Male', 'A'),
            (       'Collective noun', 'A'),
            (  'Collateral adjective', 'A'),
            ('Culinary noun for meat', 'A')],
           )
</pre>
<p>Hmm..</p>
<div class="highlight">
<pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
<pre class="example">
Index(['Animal', 'Young', 'Female', 'Male', 'Collective noun',
       'Collateral adjective', 'Culinary noun for meat'],
      dtype='object')
</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-right">
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Animal</th>
<th class="org-left" scope="col">Young</th>
<th class="org-left" scope="col">Female</th>
<th class="org-left" scope="col">Male</th>
<th class="org-right" scope="col">Collective noun</th>
<th class="org-left" scope="col">Collateral adjective</th>
<th class="org-right" scope="col">Culinary noun for meat</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Aardvark</td>
<td class="org-left">cub</td>
<td class="org-left">sow</td>
<td class="org-left">boar</td>
<td class="org-right">nan</td>
<td class="org-left">orycteropodian</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="outline-3" id="outline-container-orgf0d95dc">
<h3 id="orgf0d95dc">Meats</h3>
<div class="outline-text-3" id="text-orgf0d95dc">
<p>At this point I don't know what I really want to do with this. I was originally going to just save the animal names but now the other stuff looks kind of interesting. As an aside I had to look up <a href="https://en.wikipedia.org/wiki/Collateral_adjective">Collateral Adjective</a> on wikipedia:</p>
<blockquote>
<p>A collateral adjective is an adjective that is identified with a particular noun in meaning, but that is not derived from that noun.</p>
</blockquote>
<p>Good to know.</p>
<div class="highlight">
<pre><span></span><span class="n">meats</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Culinary noun for meat"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meats</span><span class="p">))</span>
</pre></div>
<pre class="example">
49
</pre>
<p>So, now I noticed something else wrong.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">meats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Animal</th>
<th class="org-left" scope="col">Young</th>
<th class="org-left" scope="col">Female</th>
<th class="org-left" scope="col">Male</th>
<th class="org-left" scope="col">Collective noun</th>
<th class="org-left" scope="col">Collateral adjective</th>
<th class="org-left" scope="col">Culinary noun for meat</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Z</td>
<td class="org-left">Z</td>
<td class="org-left">Z</td>
<td class="org-left">Z</td>
<td class="org-left">Z</td>
<td class="org-left">Z</td>
<td class="org-left">Z</td>
</tr>
</tbody>
</table>
<p>Oops. Maybe I should have looked at the table more closely.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org60be98d">
<h3 id="org60be98d">Again, But With Soup This Time</h3>
<div class="outline-text-3" id="text-org60be98d">
<p>Let's see if using Beautiful Soup will help clean up the dataset a little.</p>
<div class="highlight">
<pre><span></span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">)</span>
<span class="n">soup_table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"table"</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
<p>The <code>read_html</code> method always returns a list, even though I'm only passing in one table.</p>
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup_table</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">('Animal', 'A')</th>
<th class="org-left" scope="col">('Young', 'A')</th>
<th class="org-left" scope="col">('Female', 'A')</th>
<th class="org-left" scope="col">('Male', 'A')</th>
<th class="org-left" scope="col">('Collective noun', 'A')</th>
<th class="org-left" scope="col">('Collateral adjective', 'A')</th>
<th class="org-right" scope="col">('Culinary noun for meat', 'A')</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Zebra</td>
<td class="org-left">foal colt (male) filly (female)</td>
<td class="org-left">mare</td>
<td class="org-left">stallion</td>
<td class="org-left">herd[11][107] cohort[107]dazzle [108] zeal[11][107]</td>
<td class="org-left">zebrine hippotigrine</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>
<p>Actually, that looks worse.</p>
<p>I went back and looked at the page and the table is broken up by sub-headers indicating the first letter of the animal's name.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup_table</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)[</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
<pre class="example">
&lt;th colspan="7"&gt;&lt;span id="A"&gt;&lt;/span&gt;&lt;b&gt;A&lt;/b&gt;
</pre>
<p>So, maybe I can clean that up a little before creating the table - here's where Beautiful Soup comes in. First I'll find all the tags whose ID matches a letter of the alphabet and then I'll use the <code>decompose</code> method to destroy the grand-parent of that tag - decompose destroys both the tag it's called on and all the descendants of that tag so this will destroy the grand-parent (table-row tag), parent (table-header) and matching tag (span with the ID matching the letter) and it's child (the bold tag). I'm also calling <code>smooth</code> and <code>encode</code> to clean the tree up once the tags are destroyed, although, to be honest, I don't know if that's really needed here, it just seemed like a good idea.</p>
<div class="highlight">
<pre><span></span><span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">ascii_uppercase</span><span class="p">:</span>
    <span class="n">element</span> <span class="o">=</span> <span class="n">soup_table</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">character</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Element for {character} not found"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">element</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>

<span class="n">soup_table</span><span class="o">.</span><span class="n">smooth</span><span class="p">()</span>
<span class="n">soup_table</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup_table</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-right">
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Animal</th>
<th class="org-left" scope="col">Young</th>
<th class="org-left" scope="col">Female</th>
<th class="org-left" scope="col">Male</th>
<th class="org-right" scope="col">Collective noun</th>
<th class="org-left" scope="col">Collateral adjective</th>
<th class="org-right" scope="col">Culinary noun for meat</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Aardvark</td>
<td class="org-left">cub</td>
<td class="org-left">sow</td>
<td class="org-left">boar</td>
<td class="org-right">nan</td>
<td class="org-left">orycteropodian</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>
<p>So, now our first row is for <i>Aardvark</i> instead of the letter <i>A</i>. And now back to the meats.</p>
<div class="highlight">
<pre><span></span><span class="n">meats</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Culinary noun for meat"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meats</span><span class="p">))</span>
</pre></div>
<pre class="example">
24
</pre>
<p>There are twenty-four entries in our table that have a noun referring to the animal as meat. Let's see what they are.</p>
<div class="highlight">
<pre><span></span><span class="n">meats</span> <span class="o">=</span> <span class="n">meats</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Culinary noun for meat"</span><span class="p">:</span> <span class="s2">"Meat"</span><span class="p">})</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">meats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{row.Animal}: {row.Meat}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Cattle[note 3] (list): beef veal
Chicken (list): poultry
Deer: venison humble (organ meat)
DogfishAlso see Shark: Spiny dogfish capeshark (USA) flake (UK, AUS) huss (UK) kahada (CAN)[50] rigg (UK)rock salmon (UK)
Duck (list) Also see Mallard: poultry
Elk (wapiti): venison
Gaur: garabeef
Goat (list): chevon cabrito mutton
Goose: poultry
Guinea fowl: poultry
Guinea pig: cuy
MallardAlso see Duck: poultry
Moose: venison
Peafowl: poultry
Pig (list) Also see Boar: pork ham bacon
Pigeon (list): squab
RamAlso see Sheep: lamb mutton
Red deer: venison
Shark: flake (AUS)
Sheep (list) Also see Ram: lamb mutton hogget
Snail: escargot
Turkey (list): poultry
Water buffalo: carabeef
Whale: blubber
</pre>
<p>So now there's another problem - there are footnotes and links that makes things a bit messy. We could just clear out all link references in the HTML but that would destroy the animal names which are themselves links so I'll just do some string substitution in pandas instead to erase them.</p>
<div class="highlight">
<pre><span></span><span class="n">FOOTNOTES</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"\[\w*\s*\d\]"</span>
<span class="n">FOOTNOTES_2</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"\s"</span> <span class="o">+</span> <span class="n">FOOTNOTES</span>
<span class="n">EMPTY</span> <span class="o">=</span> <span class="s2">""</span>
<span class="n">SPACE</span> <span class="o">=</span> <span class="s2">" "</span>
<span class="n">LIST</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"\(list\)"</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">FOOTNOTES_2</span><span class="p">,</span> <span class="n">EMPTY</span><span class="p">)</span>
    <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">FOOTNOTES</span><span class="p">,</span> <span class="n">SPACE</span><span class="p">)</span>
    <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">LIST</span><span class="p">,</span> <span class="n">EMPTY</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">32</span><span class="p">:</span><span class="mi">32</span><span class="p">])</span>
</pre></div>
<pre class="example">

      Animal  Young Female  Male                       Collective noun  \
32  Cattle    calf    cow   bull  herd  drove  yoke (oxen) team (oxen)   

                                 Collateral adjective Culinary noun for meat  
32  bovine  taurine (male) vaccine (female) vituli...              beef veal  
</pre>
<div class="highlight">
<pre><span></span><span class="n">meats</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Culinary noun for meat"</span><span class="p">])</span>
<span class="n">meats</span> <span class="o">=</span> <span class="n">meats</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Culinary noun for meat"</span><span class="p">:</span> <span class="s2">"Meat"</span><span class="p">})</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">meats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{row.Animal}: {row.Meat}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Cattle  : beef veal
Chicken : poultry
Deer: venison humble (organ meat)
DogfishAlso see Shark: Spiny dogfish capeshark (USA) flake (UK, AUS) huss (UK) kahada (CAN)  rigg (UK)rock salmon (UK)
Duck  Also see Mallard: poultry
Elk (wapiti): venison
Gaur: garabeef
Goat : chevon cabrito mutton
Goose: poultry
Guinea fowl: poultry
Guinea pig: cuy
MallardAlso see Duck: poultry
Moose: venison
Peafowl: poultry
Pig  Also see Boar: pork ham bacon
Pigeon : squab
RamAlso see Sheep: lamb mutton
Red deer: venison
Shark: flake (AUS)
Sheep  Also see Ram: lamb mutton hogget
Snail: escargot
Turkey : poultry
Water buffalo: carabeef
Whale: blubber
</pre>
<p>And now we have another prolbem - there's a weird smashing together of words (e.g. <code>DogfishAlso</code>) which appears to happen because wikipedia inserts <code>&lt;br/&gt;</code> tags to create a sub-row within the table rows and pandas appears to smash the rows together. Time to try again - I'm going to reload the soup and add a <code>replace</code> call to get rid of the breaks.</p>
<div class="highlight">
<pre><span></span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">)</span>
<span class="n">soup_table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"table"</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">ascii_uppercase</span><span class="p">:</span>
    <span class="n">element</span> <span class="o">=</span> <span class="n">soup_table</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">character</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Element for {character} not found"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">element</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>

<span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">soup_table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"br"</span><span class="p">):</span>
    <span class="n">tag</span><span class="o">.</span><span class="n">replace_with</span><span class="p">(</span><span class="n">SPACE</span><span class="p">)</span>

<span class="n">soup_table</span><span class="o">.</span><span class="n">smooth</span><span class="p">()</span>
<span class="n">soup_table</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup_table</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">Animal</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"Ram"</span><span class="p">)]))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Animal</th>
<th class="org-left" scope="col">Young</th>
<th class="org-left" scope="col">Female</th>
<th class="org-left" scope="col">Male</th>
<th class="org-left" scope="col">Collective noun</th>
<th class="org-left" scope="col">Collateral adjective</th>
<th class="org-left" scope="col">Culinary noun for meat</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Ram Also see Sheep</td>
<td class="org-left">lamb</td>
<td class="org-left">ewe</td>
<td class="org-left">ram</td>
<td class="org-left">flock</td>
<td class="org-left">arietine ovine</td>
<td class="org-left">lamb mutton</td>
</tr>
</tbody>
</table>
<p>So that fixes the smashing together, time to get rid of the footnotes and links to lists.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">32</span><span class="p">:</span><span class="mi">32</span><span class="p">])</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">FOOTNOTES_2</span><span class="p">,</span> <span class="n">EMPTY</span><span class="p">)</span>
    <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">FOOTNOTES</span><span class="p">,</span> <span class="n">SPACE</span><span class="p">)</span>
    <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">LIST</span><span class="p">,</span> <span class="n">EMPTY</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">32</span><span class="p">:</span><span class="mi">32</span><span class="p">])</span>
</pre></div>
<pre class="example">
                   Animal     Young   Female  Male  \
32  Cattle[note 3] (list)  calf[31]  cow[32]  bull   

                               Collective noun  \
32  herd[11] drove[11] yoke (oxen) team (oxen)   

                                 Collateral adjective Culinary noun for meat  
32  bovine[note 4] taurine (male) vaccine (female)...              beef veal  

      Animal  Young Female  Male                       Collective noun  \
32  Cattle    calf    cow   bull  herd  drove  yoke (oxen) team (oxen)   

                                 Collateral adjective Culinary noun for meat  
32  bovine  taurine (male) vaccine (female) vituli...              beef veal  
</pre>
<p>And once again, the meats.</p>
<div class="highlight">
<pre><span></span><span class="n">meats</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Culinary noun for meat"</span><span class="p">])</span>
<span class="n">meats</span> <span class="o">=</span> <span class="n">meats</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Culinary noun for meat"</span><span class="p">:</span> <span class="s2">"Meat"</span><span class="p">})</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">meats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{row.Animal}: {row.Meat}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Cattle  : beef veal
Chicken : poultry
Deer: venison humble (organ meat)
Dogfish Also see Shark: Spiny dogfish capeshark (USA) flake (UK, AUS) huss (UK) kahada (CAN)  rigg (UK) rock salmon (UK)
Duck  Also see Mallard: poultry
Elk (wapiti): venison
Gaur: garabeef
Goat : chevon cabrito mutton
Goose: poultry
Guinea fowl: poultry
Guinea pig: cuy
Mallard Also see Duck: poultry
Moose: venison
Peafowl: poultry
Pig  Also see Boar: pork ham bacon
Pigeon : squab
Ram Also see Sheep: lamb mutton
Red deer: venison
Shark: flake (AUS)
Sheep  Also see Ram: lamb mutton hogget
Snail: escargot
Turkey : poultry
Water buffalo: carabeef
Whale: blubber
</pre>
<p>This isn't quite the nice set that I was hoping for, but, oh well. Maybe just one more clean-up to put paretheses around the <i>Also see</i> statements and onward.</p>
<div class="highlight">
<pre><span></span><span class="n">PATTERN</span> <span class="o">=</span> <span class="s2">"Also see (?P&lt;name&gt;\w+)"</span>
<span class="k">def</span> <span class="nf">see_also</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">f</span><span class="s2">"(Also see {name})"</span>

<span class="n">table</span><span class="p">[</span><span class="s2">"Animal"</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">Animal</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">PATTERN</span><span class="p">,</span> <span class="n">see_also</span><span class="p">)</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="n">meats</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Culinary noun for meat"</span><span class="p">])</span>
<span class="n">meats</span> <span class="o">=</span> <span class="n">meats</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Culinary noun for meat"</span><span class="p">:</span> <span class="s2">"Meat"</span><span class="p">})</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">meats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"{row.Animal}: {row.Meat}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Cattle: beef veal
Chicken: poultry
Deer: venison humble (organ meat)
Dogfish (Also see Shark): Spiny dogfish capeshark (USA) flake (UK, AUS) huss (UK) kahada (CAN)  rigg (UK) rock salmon (UK)
Duck  (Also see Mallard): poultry
Elk (wapiti): venison
Gaur: garabeef
Goat: chevon cabrito mutton
Goose: poultry
Guinea fowl: poultry
Guinea pig: cuy
Mallard (Also see Duck): poultry
Moose: venison
Peafowl: poultry
Pig  (Also see Boar): pork ham bacon
Pigeon: squab
Ram (Also see Sheep): lamb mutton
Red deer: venison
Shark: flake (AUS)
Sheep  (Also see Ram): lamb mutton hogget
Snail: escargot
Turkey: poultry
Water buffalo: carabeef
Whale: blubber
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org94604aa">
<h2 id="org94604aa">End</h2>
<div class="outline-text-2" id="text-org94604aa">
<p>And now to save it for later.</p>
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">()</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"WIKIPEDIA"</span><span class="p">])</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
    <span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"WIKIPEDIA_ANIMALS"</span><span class="p">])</span>
<span class="n">table</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
<p>And for an example use.</p>
<div class="highlight">
<pre><span></span><span class="n">animals</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"WIKIPEDIA_ANIMALS"</span><span class="p">])</span><span class="o">.</span><span class="n">expanduser</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="n">animals</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
<pre class="example">
Animal                    Marmoset
Young                       infant
Female                           ?
Male                             ?
Collective noun                  ?
Collateral adjective        simian
Culinary noun for meat         NaN
Name: 155, dtype: object
</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">meats</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
<pre class="example">
Animal                                           Dogfish (Also see Shark)
Young                                                                   ?
Female                                                                  ?
Male                                                                    ?
Collective noun                                                     troop
Collateral adjective                                   selachian squaloid
Meat                    Spiny dogfish capeshark (USA) flake (UK, AUS) ...
Name: 59, dtype: object
</pre>
<p>So, there we go. What have we learned?</p>
<ul class="org-ul">
<li>How to pull a page from wikipedia using Selenium</li>
<li>How to find and clean a wikipedia table using Beautiful Soup</li>
<li>How to convert the Beautiful Soup object to a pandas DataFrame</li>
<li>How to further clean up the data frame using string methods and save the table for later as a CSV</li>
</ul>
<p>Not so exciting, but it took longer than I thought it would. I blame dog-days of August - the heat, it drives one mental.</p>
</div>
</div>
</div>
</article>
</div>
<!--End of body content-->
<footer id="footer">Contents © 2020 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script>
</body>
</html>
